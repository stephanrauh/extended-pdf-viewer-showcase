<div class="flex-container-column fill-container">
  @if (!(fullscreenService.isFullscreen$ | async)) {
    <div class="flex-container-row">
      <div
        class="bg-white border border-gray-300 rounded-lg shadow-mat-8 p-6 distance16 margin-right"
        style="flex: 1 1 100%; box-sizing: border-box; max-width: 45%"
      >
        <div class="w-full">
          <!-- Tab buttons -->
          <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 0"
              [class.border-primary-600]="selectedTab === 0"
              [class.text-gray-500]="selectedTab !== 0"
              [class.border-transparent]="selectedTab !== 0"
              (click)="selectedTab = 0"
            >
              Getting started
            </button>
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 1"
              [class.border-primary-600]="selectedTab === 1"
              [class.text-gray-500]="selectedTab !== 1"
              [class.border-transparent]="selectedTab !== 1"
              (click)="selectedTab = 1"
            >
              Basic parameters
            </button>
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 2"
              [class.border-primary-600]="selectedTab === 2"
              [class.text-gray-500]="selectedTab !== 2"
              [class.border-transparent]="selectedTab !== 2"
              (click)="selectedTab = 2"
            >
              Page and page label
            </button>
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 3"
              [class.border-primary-600]="selectedTab === 3"
              [class.text-gray-500]="selectedTab !== 3"
              [class.border-transparent]="selectedTab !== 3"
              (click)="selectedTab = 3"
            >
              Debugging
            </button>
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 4"
              [class.border-primary-600]="selectedTab === 4"
              [class.text-gray-500]="selectedTab !== 4"
              [class.border-transparent]="selectedTab !== 4"
              (click)="selectedTab = 4"
            >
              Color themes
            </button>
            <button
              class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
              [class.text-primary-600]="selectedTab === 5"
              [class.border-primary-600]="selectedTab === 5"
              [class.text-gray-500]="selectedTab !== 5"
              [class.border-transparent]="selectedTab !== 5"
              (click)="selectedTab = 5"
            >
              Height
            </button>
          </div>
          </div>

          <!-- Tab content -->
          @if (selectedTab === 0) {
            <div class="tab-content">
              <p>
                Open a terminal and enter this command at your project's root folder:
                <code>ng add ngx-extended-pdf-viewer</code>
                This configures your project, adds an example component and an example PDF file, so you just need to add the new
                <code>&lt;add-example-pdf-viewer></code> tag to one of your <code>*.html</code> files.
              </p>
            </div>
          }
          @if (selectedTab === 1) {
            <div class="tab-content">
              <p>This demo shows the default viewer. The default configuration is pretty straightforward, as you can see on the right-hand side.</p>
              <p>
                If you've set up the PDF viewer, but are missing the find dialog and the text selection: that's a performance optimization. Activate the
                `[textLayer]` to enable these two features.
              </p>
              <p>
                The <code>height</code> attribute can often be omitted, too. The showcase only needs it because its layout framework, Angular Material, sets the
                height of the PDF viewer to zero pixels by default.
              </p>
            </div>
          }
          @if (selectedTab === 2) {
            <div class="tab-content">
              <p>The page is the number page number. It always starts with 1.</p>
              <p>
                The page label is the page number assigned by the author of the PDF document. For example, the document below uses roman numbers for the table
                of contents and arabic numbers for the main body.
              </p>
              <p>
                If you try to use both `[(page)]` and `[(pageLabel)]` with two-way binding, you'll run into `ExpressionChangedAfterItHasBeenCheckedErrors`. To
                prevent this, you'll want to adopt the `OnPush` change detection strategy.
              </p>
              <div class="space-y-2">
                <label for="page-number-input" class="block text-sm font-medium text-gray-700">Current page number</label>
                <input
                  id="page-number-input"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  [(ngModel)]="page"
                />
              </div>
              <div class="space-y-2">
                <label for="page-label-input" class="block text-sm font-medium text-gray-700">Current page label</label>
                <input
                  id="page-label-input"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  [(ngModel)]="pageLabel"
                />
              </div>
            </div>
          }
          @if (selectedTab === 3) {
            <div class="tab-content">
              <p>
                This library consists of two parts: the base library, pdf.js, and the TypeScript code. If you run into errors, debugging the TypeScript code is
                usually straight-forwards. Unfortunately, most errors occur in the base library, and it's difficult to find out what's going on in the minified
                code.
              </p>
              <p>
                If you run into an error, please activate <code>[minifiedJSLibraries]="false"</code>. The viewer loads a bit slower, but you can see the error
                message and debug the JavaScript code. If you report a bug on GitHub, please include the error message and the stacktrace of the non-minified
                code.
              </p>
              <p>
                The setting <code>[forceUsingLegacyES5]="true"</code> is usually set internally in the library. Only use it if you've tried everything else. It
                allows you to run the viewer on old browsers, at least to a limited extend. Usually compatibility starts deteriorating with browsers that are
                two years old. Debugging the ES5 code isn't fun - it's partially minified and it's using old syntax.
              </p>
              <label class="flex items-center space-x-2">
                <input type="checkbox" class="form-checkbox text-primary-600" class="margin" [(ngModel)]="minifiedJSLibraries" />
                <span>use the minified JS libraries</span>
              </label>
              <label class="flex items-center space-x-2">
                <input
                  type="checkbox"
                  class="form-checkbox text-primary-600"
                  class="margin"
                  [(ngModel)]="forceUsingLegacyES5"
                  [disabled]="minifiedJSLibraries"
                />
                <span>force using ES5 code for old browsers</span>
              </label>
            </div>
          }
          @if (selectedTab === 4) {
            <div class="tab-content">
              <p>
                You can choose between two predefined color themes, or you can provide your own custom color theme. Note that switching the themes doesn't work
                reliably without a full reload (i.e. hitting the F5 or CMD+R key). This demo reloads the page programmatically each time you change the theme.
              </p>
              @if (localStorageIsSupported()) {
                <div class="radio-group">
                  <label>
                    <input
                      type="radio"
                      class="form-radio text-primary-600"
                      value="dark"
                      name="theme"
                      aria-label="Color themes"
                      [(ngModel)]="theme"
                    />
                    <span>dark theme</span>
                  </label>
                  <label>
                    <input
                      type="radio"
                      class="form-radio text-primary-600"
                      value="light"
                      name="theme"
                      aria-label="Color themes"
                      [(ngModel)]="theme"
                    />
                    <span>light theme</span>
                  </label>
                </div>
              }
              @if (!localStorageIsSupported()) {
                <p>The interactive live demo is deactivated because your browser doesn't support localStorage.</p>
              }
            </div>
          }
          @if (selectedTab === 5) {
            <div class="tab-content">
              <p>
                If you omit the <code>[height]</code> attribute, the PDF viewer tries to use all the available vertical space. To make this work, make sure the
                surrounding container is large enough to contain the PDF viewer. By default, many CSS frameworks set the height of an empty container to zero
                pixels. You can use the <code>height</code> attribute to work around this limitation or to fine-tune the amount of screen estate you need.
              </p>
              <div class="radio-group">
                <label>
                  <input type="radio" class="form-radio text-primary-600" name="height" [value]="undefined" [(ngModel)]="height" />
                  <span>default (i.e. [height]="undefined")</span>
                </label>
                <label>
                  <input type="radio" class="form-radio text-primary-600" name="height" value="100%" aria-label="Height" [(ngModel)]="height" />
                  <span>[height]="'100%'"</span>
                </label>
                <label>
                  <input type="radio" class="form-radio text-primary-600" name="height" value="95%" aria-label="Height" [(ngModel)]="height" />
                  <span>[height]="'95%'"</span>
                </label>
                <label>
                  <input type="radio" class="form-radio text-primary-600" name="height" value="90vh" aria-label="Height" [(ngModel)]="height" />
                  <span>[height]="'90vh'"</span>
                </label>
                <label>
                  <input type="radio" class="form-radio text-primary-600" name="height" value="200px" aria-label="Height" [(ngModel)]="height" />
                  <span>[height]="'200px'"</span>
                </label>
              </div>
            </div>
          }
        </div>
      </div>
      <div
        class="bg-white border border-gray-300 rounded-lg shadow-mat-8 p-6 distance16 progress"
        style="flex: 1 1 100%; box-sizing: border-box; max-width: 53%"
      >
        @if (selectedTab === 0) {
          <div>
            <div class="w-full">
              <!-- Tab buttons -->
              <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
                <button
                  class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                  [class.text-primary-600]="codeTab === 'htmltemplate'"
                  [class.border-primary-600]="codeTab === 'htmltemplate'"
                  [class.text-gray-500]="codeTab !== 'htmltemplate'"
                  [class.border-transparent]="codeTab !== 'htmltemplate'"
                  (click)="codeTab = 'htmltemplate'"
                >
                  HTML template
                </button>
              </div>
          </div>

              <!-- Tab content -->
              @if (codeTab === 'htmltemplate') {
                <div class="tab-content">
                  <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/html.md"> </app-ie11-markdown>
                </div>
              }
            </div>
          </div>
        }
        @if (selectedTab === 1) {
          <div class="w-full">
            <!-- Tab buttons -->
            <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
              <button
                class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                [class.text-primary-600]="codeTab === 'htmltemplate'"
                [class.border-primary-600]="codeTab === 'htmltemplate'"
                [class.text-gray-500]="codeTab !== 'htmltemplate'"
                [class.border-transparent]="codeTab !== 'htmltemplate'"
                (click)="codeTab = 'htmltemplate'"
              >
                HTML template
              </button>
              <button
                class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                [class.text-primary-600]="codeTab === 'typescript'"
                [class.border-primary-600]="codeTab === 'typescript'"
                [class.text-gray-500]="codeTab !== 'typescript'"
                [class.border-transparent]="codeTab !== 'typescript'"
                (click)="codeTab = 'typescript'"
              >
                Typescript
              </button>
            </div>
          </div>

            <!-- Tab content -->
            @if (codeTab === 'htmltemplate') {
              <div class="tab-content">
                <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/html2.md"> </app-ie11-markdown>
              </div>
            }
            @if (codeTab === 'typescript') {
              <div class="tab-content">
                <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/ts.md"> </app-ie11-markdown>
              </div>
            }
          </div>
        }
        @if (selectedTab === 2) {
          <div class="w-full">
            <!-- Tab buttons -->
            <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
              <button
                class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                [class.text-primary-600]="codeTab === 'htmltemplate'"
                [class.border-primary-600]="codeTab === 'htmltemplate'"
                [class.text-gray-500]="codeTab !== 'htmltemplate'"
                [class.border-transparent]="codeTab !== 'htmltemplate'"
                (click)="codeTab = 'htmltemplate'"
              >
                HTML template
              </button>
              <button
                class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                [class.text-primary-600]="codeTab === 'typescript'"
                [class.border-primary-600]="codeTab === 'typescript'"
                [class.text-gray-500]="codeTab !== 'typescript'"
                [class.border-transparent]="codeTab !== 'typescript'"
                (click)="codeTab = 'typescript'"
              >
                Typescript
              </button>
            </div>
          </div>

            <!-- Tab content -->
            @if (codeTab === 'htmltemplate') {
              <div class="tab-content">
                <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/html3.md"> </app-ie11-markdown>
              </div>
            }
            @if (codeTab === 'typescript') {
              <div class="tab-content">
                <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/ts3.md"> </app-ie11-markdown>
              </div>
            }
          </div>
        }
        @if (selectedTab === 3) {
          <div class="w-full">
            <!-- Tab buttons -->
            <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
              <button
                class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
                [class.text-primary-600]="codeTab === 'htmltemplate'"
                [class.border-primary-600]="codeTab === 'htmltemplate'"
                [class.text-gray-500]="codeTab !== 'htmltemplate'"
                [class.border-transparent]="codeTab !== 'htmltemplate'"
                (click)="codeTab = 'htmltemplate'"
              >
                HTML template
              </button>
            </div>
          </div>

            <!-- Tab content -->
            @if (codeTab === 'htmltemplate') {
              <div class="tab-content">
                <app-ie11-markdown ngPreserveWhitespaces src="/assets/extended-pdf-viewer/simple/html4.md"> </app-ie11-markdown>
              </div>
            }
          </div>
        }
      </div>
    </div>
  }

  <app-demo
    [src]="'./assets/pdfs/The Public Domain - Enclosing the Commons of the Mind.pdf'"
    [showNote]="true"
    [additionalNote]="'Note there\'s a bug in the PDF file. See the annotation layer demo to see the bugfix.'"
  >
    <small slot="additional-info">
      <br />
      @if (time) {
        <span>Time till page 5 shows: {{ time }} ms; last rendering time: {{ currentTime }} ms</span>
      }
      @if (!time) {
        <span>&nbsp;</span>
      }
    </small>

    <div style="width: 100%">
      <div class="w-full">
        <!-- Tab buttons -->
        <div class="overflow-x-auto">
            <div class="flex space-x-2 w-max border-b border-gray-200 mb-2">
          <button
            class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
            [class.text-primary-600]="bottomTab === 'livedemo'"
            [class.border-primary-600]="bottomTab === 'livedemo'"
            [class.text-gray-500]="bottomTab !== 'livedemo'"
            [class.border-transparent]="bottomTab !== 'livedemo'"
            (click)="bottomTab = 'livedemo'"
          >
            live demo
          </button>
          <button
            class="px-3 py-1.5 text-xs font-medium border-b-2 focus:outline-none"
            [class.text-primary-600]="bottomTab === 'consolemessages'"
            [class.border-primary-600]="bottomTab === 'consolemessages'"
            [class.text-gray-500]="bottomTab !== 'consolemessages'"
            [class.border-transparent]="bottomTab !== 'consolemessages'"
            (click)="bottomTab = 'consolemessages'"
          >
            console messages
          </button>
        </div>
          </div>

        <!-- Tab content -->
        @if (bottomTab === 'livedemo') {
          <div class="tab-content">
            @if (showPdfViewer) {
              <ngx-extended-pdf-viewer
                [src]="'./assets/pdfs/The Public Domain - Enclosing the Commons of the Mind.pdf'"
                [zoom]="'auto'"
                [height]="height"
                [textLayer]="true"
                [showPresentationModeButton]="true"
                [(page)]="page"
                [(pageLabel)]="pageLabel"
                [theme]="theme"
                (updateFindMatchesCount)="onUpdateFindResult($event)"
                (pageRendered)="onPageRendered($event)"
                (pageLoaded)="onPageLoaded($event)"
                [filenameForDownload]="'The Public Domain - Enclosing the Commons of the Mind.pdf'"
                [minifiedJSLibraries]="minifiedJSLibraries"
                [forceUsingLegacyES5]="forceUsingLegacyES5"
              >
              </ngx-extended-pdf-viewer>
            }
          </div>
        }
        @if (bottomTab === 'consolemessages') {
          <div class="tab-content">
            @for (l of logService.logs; track $index) {
              <div>
                {{ l }}
              </div>
            }
          </div>
        }
      </div>
    </div>
  </app-demo>
</div>
